<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nguyễn Ngọc Bình">

<title>Making sharable documents - Isolation Forest - anomaly detection</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Isolation Forest - anomaly detection</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/b_hex.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://nguyenngocbinh.github.io/papers" rel="" title="nguyenngocbinh.github.io/papers" class="quarto-navigation-tool px-1" aria-label="nguyenngocbinh.github.io/papers"><i class="bi bi-globe"></i></a>
    <a href="https://github.com/nguyenngocbinh/papers" rel="" title="github" class="quarto-navigation-tool px-1" aria-label="github"><i class="bi bi-github"></i></a>
    <a href="https://twitter.com/nanabi88" rel="" title="nanabi88 Twitter" class="quarto-navigation-tool px-1" aria-label="nanabi88 Twitter"><i class="bi bi-twitter"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./irb/ModelGuideline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model guideline</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./irb/ModelGuideline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model guideline</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./machine-learning/Index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine learning</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine-learning/focal-loss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Focal loss - handle class imbalance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine-learning/delong_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Delong method for AUC interval and AUC test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine-learning/FeatureImportance_Permutation_versus_MeanDecrease.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overestimate feature importance in Random Forest</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine-learning/SHAP_SHapley_Additive_exPlanations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SHAP values and Coefficients of Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine-learning/CohortFitDistribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fit Distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine-learning/modelCalibration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model calibration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine-learning/transformer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transformer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine-learning/ReinforcementLearningConcept.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reinforcement Learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine-learning/EnhanceTraditionalScoreCardByReinforcementLearning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Use Reinforcement learning to enhance traditional scorecard</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">machine-learning/IsolationForest.ipynb</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">machine-learning/Autoencoders.ipynb</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./statistic/Index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistic</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistic/StandardizedCoefficients.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Standardized Coefficients vs Unstandardized Coefficients</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistic/confidenceIntervalWithSmallSampleSize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ước lượng khoảng tin cậy với cỡ mẫu nhỏ</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistic/PSI_KS_ENTROPY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Giám sát độ ổn định của mô hình</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistic/DiD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Difference-in-Differences (DiD)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistic/MonteCarlo_Bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">So sánh giữa Monte Carlo Simulation và Bootstrap</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./explore.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explore and setup</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./quarto-workflows/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto workflows</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto-workflows/browser.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">From the Browser</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto-workflows/rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">From RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto-workflows/jupyter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">From Jupyter</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./learning-more.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning more</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transition-from-rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transition from Rmd</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sử-dụng-thuật-toán-isolation-forest-cho-việc-phát-hiện-dấu-hiệu-bất-thường-anomaly-detection" id="toc-sử-dụng-thuật-toán-isolation-forest-cho-việc-phát-hiện-dấu-hiệu-bất-thường-anomaly-detection" class="nav-link active" data-scroll-target="#sử-dụng-thuật-toán-isolation-forest-cho-việc-phát-hiện-dấu-hiệu-bất-thường-anomaly-detection">Sử dụng thuật toán Isolation Forest cho việc phát hiện dấu hiệu bất thường (anomaly detection)</a></li>
  <li><a href="#nhược-điểm-của-isolation-forest" id="toc-nhược-điểm-của-isolation-forest" class="nav-link" data-scroll-target="#nhược-điểm-của-isolation-forest">Nhược điểm của Isolation Forest</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.dev/nguyenngocbinh/papers/blob/main/IsolationForest.ipynb" class="toc-action">Edit this page</a></p><p><a href="https://github.com/nguyenngocbinh/papers/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Isolation Forest - anomaly detection</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nguyễn Ngọc Bình </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="sử-dụng-thuật-toán-isolation-forest-cho-việc-phát-hiện-dấu-hiệu-bất-thường-anomaly-detection" class="level2">
<h2 class="anchored" data-anchor-id="sử-dụng-thuật-toán-isolation-forest-cho-việc-phát-hiện-dấu-hiệu-bất-thường-anomaly-detection">Sử dụng thuật toán Isolation Forest cho việc phát hiện dấu hiệu bất thường (anomaly detection)</h2>
<p><strong>Bước 1: Chuẩn bị Dữ liệu</strong> - Bắt đầu bằng việc thu thập và tải dữ liệu mà bạn muốn phát hiện các dấu hiệu bất thường.</p>
<p><strong>Bước 2: Tải và Import Thư viện</strong> - Trong Python, sử dụng các thư viện sau: <code>numpy</code>, <code>pandas</code>, và <code>sklearn.ensemble</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> IsolationForest</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Bước 3: Chuẩn bị dữ liệu</strong> - Đảm bảo rằng dữ liệu của bạn đã được chuẩn bị và lấy ra từ các cột không mong muốn.</p>
<p><strong>Bước 4: Tạo Mô hình Isolation Forest</strong> - Sử dụng <code>IsolationForest</code> để tạo một mô hình phát hiện dấu hiệu bất thường. Bạn có thể tuỳ chỉnh mô hình bằng cách thay đổi các tham số, chẳng hạn như <code>contamination</code> (tỷ lệ dấu hiệu bất thường trong dữ liệu).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> IsolationForest(contamination<span class="op">=</span><span class="fl">0.05</span>)  <span class="co"># Tuỳ chỉnh contamination tại đây</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Bước 5: Huấn luyện Mô hình</strong> - Sử dụng dữ liệu huấn luyện của bạn để huấn luyện mô hình Isolation Forest.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>model.fit(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Bước 6: Dự đoán Dấu hiệu Bất thường</strong> - Sử dụng mô hình đã huấn luyện để dự đoán dấu hiệu bất thường trên tập dữ liệu kiểm tra.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> model.predict(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Bước 7: Lấy Điểm Anomaly</strong> - Sử dụng phương thức <code>decision_function</code> để lấy điểm anomaly cho mỗi mẫu dữ liệu. Điểm càng thấp càng có khả năng là dấu hiệu bất thường.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>anomaly_scores <span class="op">=</span> model.decision_function(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Bước 8: Xác định Dấu hiệu Bất thường</strong> - Dùng ngưỡng (threshold) để xác định dấu hiệu bất thường dựa trên điểm anomaly. Bạn có thể tuỳ chỉnh ngưỡng theo ý muốn.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>threshold <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>  <span class="co"># Ngưỡng ngầm định, điều chỉnh tùy theo nhu cầu</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>anomalies <span class="op">=</span> X[anomaly_scores <span class="op">&lt;</span> threshold]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Bước 9: Xuất kết quả</strong> - Xuất các mẫu bất thường mà bạn đã xác định từ dữ liệu.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Dấu hiệu bất thường:"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(anomalies)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Lưu ý rằng bạn có thể tùy chỉnh các tham số và ngưỡng để điều chỉnh độ nhạy của việc phát hiện dấu hiệu bất thường dựa trên nhu cầu của bạn.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> IsolationForest</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>data_url <span class="op">=</span> <span class="st">"https://archive.ics.uci.edu/ml/machine-learning-databases/statlog/german/german.data"</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>column_names <span class="op">=</span> [<span class="st">'existing_checking'</span>, <span class="st">'duration'</span>, <span class="st">'credit_history'</span>, <span class="st">'purpose'</span>, <span class="st">'credit_amount'</span>, <span class="st">'savings'</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">'employment'</span>, <span class="st">'installment_rate'</span>, <span class="st">'personal_status'</span>, <span class="st">'other_debtors'</span>, <span class="st">'residence_since'</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">'property'</span>, <span class="st">'age'</span>, <span class="st">'other_installment_plans'</span>, <span class="st">'housing'</span>, <span class="st">'existing_credits'</span>, <span class="st">'job'</span>, <span class="st">'people_liable'</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">'telephone'</span>, <span class="st">'foreign_worker'</span>, <span class="st">'class'</span>]</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(data_url, delimiter<span class="op">=</span><span class="st">' '</span>, names<span class="op">=</span>column_names)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocess the data</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data.drop(<span class="st">'class'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data[<span class="st">'class'</span>]</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.get_dummies(X, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an Isolation Forest model</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>contamination <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> IsolationForest(contamination<span class="op">=</span>contamination)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model to your data</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>model.fit(X)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict anomalies (1 for inliers, -1 for outliers)</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> model.predict(X)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the anomaly scores (the lower the score, the more likely it's an anomaly)</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>anomaly_scores <span class="op">=</span> model.decision_function(X)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify anomalies</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>anomalies <span class="op">=</span> data[predictions <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>c:\Users\binhnn2\anaconda3\envs\env_pycaret\lib\site-packages\sklearn\base.py:439: UserWarning: X does not have valid feature names, but IsolationForest was fitted with feature names
  warnings.warn(</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>anomalies</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">existing_checking</th>
<th data-quarto-table-cell-role="th">duration</th>
<th data-quarto-table-cell-role="th">credit_history</th>
<th data-quarto-table-cell-role="th">purpose</th>
<th data-quarto-table-cell-role="th">credit_amount</th>
<th data-quarto-table-cell-role="th">savings</th>
<th data-quarto-table-cell-role="th">employment</th>
<th data-quarto-table-cell-role="th">installment_rate</th>
<th data-quarto-table-cell-role="th">personal_status</th>
<th data-quarto-table-cell-role="th">other_debtors</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">property</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">other_installment_plans</th>
<th data-quarto-table-cell-role="th">housing</th>
<th data-quarto-table-cell-role="th">existing_credits</th>
<th data-quarto-table-cell-role="th">job</th>
<th data-quarto-table-cell-role="th">people_liable</th>
<th data-quarto-table-cell-role="th">telephone</th>
<th data-quarto-table-cell-role="th">foreign_worker</th>
<th data-quarto-table-cell-role="th">class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">44</td>
<td>A11</td>
<td>48</td>
<td>A34</td>
<td>A41</td>
<td>6143</td>
<td>A61</td>
<td>A75</td>
<td>4</td>
<td>A92</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>58</td>
<td>A142</td>
<td>A153</td>
<td>2</td>
<td>A172</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">55</td>
<td>A14</td>
<td>6</td>
<td>A31</td>
<td>A40</td>
<td>783</td>
<td>A65</td>
<td>A73</td>
<td>1</td>
<td>A93</td>
<td>A103</td>
<td>...</td>
<td>A121</td>
<td>26</td>
<td>A142</td>
<td>A152</td>
<td>1</td>
<td>A172</td>
<td>2</td>
<td>A191</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">87</td>
<td>A12</td>
<td>36</td>
<td>A32</td>
<td>A46</td>
<td>12612</td>
<td>A62</td>
<td>A73</td>
<td>1</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>47</td>
<td>A143</td>
<td>A153</td>
<td>1</td>
<td>A173</td>
<td>2</td>
<td>A192</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">99</td>
<td>A12</td>
<td>20</td>
<td>A33</td>
<td>A41</td>
<td>7057</td>
<td>A65</td>
<td>A74</td>
<td>3</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A122</td>
<td>36</td>
<td>A141</td>
<td>A151</td>
<td>2</td>
<td>A174</td>
<td>2</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">105</td>
<td>A12</td>
<td>24</td>
<td>A34</td>
<td>A410</td>
<td>11938</td>
<td>A61</td>
<td>A73</td>
<td>2</td>
<td>A93</td>
<td>A102</td>
<td>...</td>
<td>A123</td>
<td>39</td>
<td>A143</td>
<td>A152</td>
<td>2</td>
<td>A174</td>
<td>2</td>
<td>A192</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">110</td>
<td>A12</td>
<td>6</td>
<td>A33</td>
<td>A49</td>
<td>1449</td>
<td>A62</td>
<td>A75</td>
<td>1</td>
<td>A91</td>
<td>A101</td>
<td>...</td>
<td>A123</td>
<td>31</td>
<td>A141</td>
<td>A152</td>
<td>2</td>
<td>A173</td>
<td>2</td>
<td>A191</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">154</td>
<td>A12</td>
<td>24</td>
<td>A33</td>
<td>A49</td>
<td>6967</td>
<td>A62</td>
<td>A74</td>
<td>4</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A123</td>
<td>36</td>
<td>A143</td>
<td>A151</td>
<td>1</td>
<td>A174</td>
<td>1</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">157</td>
<td>A11</td>
<td>12</td>
<td>A31</td>
<td>A48</td>
<td>339</td>
<td>A61</td>
<td>A75</td>
<td>4</td>
<td>A94</td>
<td>A101</td>
<td>...</td>
<td>A123</td>
<td>45</td>
<td>A141</td>
<td>A152</td>
<td>1</td>
<td>A172</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">175</td>
<td>A14</td>
<td>30</td>
<td>A31</td>
<td>A41</td>
<td>7485</td>
<td>A65</td>
<td>A71</td>
<td>4</td>
<td>A92</td>
<td>A101</td>
<td>...</td>
<td>A121</td>
<td>53</td>
<td>A141</td>
<td>A152</td>
<td>1</td>
<td>A174</td>
<td>1</td>
<td>A192</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">181</td>
<td>A12</td>
<td>36</td>
<td>A33</td>
<td>A49</td>
<td>4455</td>
<td>A61</td>
<td>A73</td>
<td>2</td>
<td>A91</td>
<td>A101</td>
<td>...</td>
<td>A121</td>
<td>30</td>
<td>A142</td>
<td>A152</td>
<td>2</td>
<td>A174</td>
<td>1</td>
<td>A192</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">186</td>
<td>A12</td>
<td>9</td>
<td>A31</td>
<td>A41</td>
<td>5129</td>
<td>A61</td>
<td>A75</td>
<td>2</td>
<td>A92</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>74</td>
<td>A141</td>
<td>A153</td>
<td>1</td>
<td>A174</td>
<td>2</td>
<td>A192</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">191</td>
<td>A12</td>
<td>48</td>
<td>A30</td>
<td>A49</td>
<td>3844</td>
<td>A62</td>
<td>A74</td>
<td>4</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>34</td>
<td>A143</td>
<td>A153</td>
<td>1</td>
<td>A172</td>
<td>2</td>
<td>A191</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">226</td>
<td>A12</td>
<td>48</td>
<td>A32</td>
<td>A43</td>
<td>10961</td>
<td>A64</td>
<td>A74</td>
<td>1</td>
<td>A93</td>
<td>A102</td>
<td>...</td>
<td>A124</td>
<td>27</td>
<td>A141</td>
<td>A152</td>
<td>2</td>
<td>A173</td>
<td>1</td>
<td>A192</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">263</td>
<td>A14</td>
<td>12</td>
<td>A34</td>
<td>A46</td>
<td>2748</td>
<td>A61</td>
<td>A75</td>
<td>2</td>
<td>A92</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>57</td>
<td>A141</td>
<td>A153</td>
<td>3</td>
<td>A172</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">272</td>
<td>A12</td>
<td>48</td>
<td>A31</td>
<td>A40</td>
<td>12169</td>
<td>A65</td>
<td>A71</td>
<td>4</td>
<td>A93</td>
<td>A102</td>
<td>...</td>
<td>A124</td>
<td>36</td>
<td>A143</td>
<td>A153</td>
<td>1</td>
<td>A174</td>
<td>1</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">287</td>
<td>A12</td>
<td>48</td>
<td>A33</td>
<td>A410</td>
<td>7582</td>
<td>A62</td>
<td>A71</td>
<td>2</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>31</td>
<td>A143</td>
<td>A153</td>
<td>1</td>
<td>A174</td>
<td>1</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">304</td>
<td>A14</td>
<td>48</td>
<td>A34</td>
<td>A40</td>
<td>10127</td>
<td>A63</td>
<td>A73</td>
<td>2</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>44</td>
<td>A141</td>
<td>A153</td>
<td>1</td>
<td>A173</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">306</td>
<td>A14</td>
<td>30</td>
<td>A32</td>
<td>A41</td>
<td>4811</td>
<td>A65</td>
<td>A74</td>
<td>2</td>
<td>A92</td>
<td>A101</td>
<td>...</td>
<td>A122</td>
<td>24</td>
<td>A142</td>
<td>A151</td>
<td>1</td>
<td>A172</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">333</td>
<td>A14</td>
<td>48</td>
<td>A34</td>
<td>A41</td>
<td>11590</td>
<td>A62</td>
<td>A73</td>
<td>2</td>
<td>A92</td>
<td>A101</td>
<td>...</td>
<td>A123</td>
<td>24</td>
<td>A141</td>
<td>A151</td>
<td>2</td>
<td>A172</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">343</td>
<td>A12</td>
<td>18</td>
<td>A32</td>
<td>A49</td>
<td>4439</td>
<td>A61</td>
<td>A75</td>
<td>1</td>
<td>A93</td>
<td>A102</td>
<td>...</td>
<td>A121</td>
<td>33</td>
<td>A141</td>
<td>A152</td>
<td>1</td>
<td>A174</td>
<td>1</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">373</td>
<td>A14</td>
<td>60</td>
<td>A34</td>
<td>A40</td>
<td>13756</td>
<td>A65</td>
<td>A75</td>
<td>2</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>63</td>
<td>A141</td>
<td>A153</td>
<td>1</td>
<td>A174</td>
<td>1</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">374</td>
<td>A12</td>
<td>60</td>
<td>A31</td>
<td>A410</td>
<td>14782</td>
<td>A62</td>
<td>A75</td>
<td>3</td>
<td>A92</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>60</td>
<td>A141</td>
<td>A153</td>
<td>2</td>
<td>A174</td>
<td>1</td>
<td>A192</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">395</td>
<td>A12</td>
<td>39</td>
<td>A33</td>
<td>A46</td>
<td>11760</td>
<td>A62</td>
<td>A74</td>
<td>2</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>32</td>
<td>A143</td>
<td>A151</td>
<td>1</td>
<td>A173</td>
<td>1</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">449</td>
<td>A12</td>
<td>15</td>
<td>A33</td>
<td>A45</td>
<td>1512</td>
<td>A64</td>
<td>A73</td>
<td>3</td>
<td>A94</td>
<td>A101</td>
<td>...</td>
<td>A122</td>
<td>61</td>
<td>A142</td>
<td>A152</td>
<td>2</td>
<td>A173</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">496</td>
<td>A12</td>
<td>36</td>
<td>A32</td>
<td>A42</td>
<td>9034</td>
<td>A62</td>
<td>A72</td>
<td>4</td>
<td>A93</td>
<td>A102</td>
<td>...</td>
<td>A124</td>
<td>29</td>
<td>A143</td>
<td>A151</td>
<td>1</td>
<td>A174</td>
<td>1</td>
<td>A192</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">539</td>
<td>A13</td>
<td>18</td>
<td>A32</td>
<td>A42</td>
<td>3049</td>
<td>A61</td>
<td>A72</td>
<td>1</td>
<td>A92</td>
<td>A101</td>
<td>...</td>
<td>A122</td>
<td>45</td>
<td>A142</td>
<td>A152</td>
<td>1</td>
<td>A172</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">549</td>
<td>A14</td>
<td>48</td>
<td>A34</td>
<td>A41</td>
<td>8858</td>
<td>A65</td>
<td>A74</td>
<td>2</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>35</td>
<td>A143</td>
<td>A153</td>
<td>2</td>
<td>A173</td>
<td>1</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">551</td>
<td>A14</td>
<td>6</td>
<td>A31</td>
<td>A43</td>
<td>1750</td>
<td>A63</td>
<td>A75</td>
<td>2</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A122</td>
<td>45</td>
<td>A141</td>
<td>A152</td>
<td>1</td>
<td>A172</td>
<td>2</td>
<td>A191</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">595</td>
<td>A12</td>
<td>6</td>
<td>A31</td>
<td>A40</td>
<td>931</td>
<td>A62</td>
<td>A72</td>
<td>1</td>
<td>A92</td>
<td>A101</td>
<td>...</td>
<td>A122</td>
<td>32</td>
<td>A142</td>
<td>A152</td>
<td>1</td>
<td>A172</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">602</td>
<td>A12</td>
<td>24</td>
<td>A31</td>
<td>A46</td>
<td>1837</td>
<td>A61</td>
<td>A74</td>
<td>4</td>
<td>A92</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>34</td>
<td>A141</td>
<td>A153</td>
<td>1</td>
<td>A172</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">607</td>
<td>A12</td>
<td>36</td>
<td>A32</td>
<td>A43</td>
<td>2671</td>
<td>A62</td>
<td>A73</td>
<td>4</td>
<td>A92</td>
<td>A102</td>
<td>...</td>
<td>A124</td>
<td>50</td>
<td>A143</td>
<td>A153</td>
<td>1</td>
<td>A173</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">611</td>
<td>A13</td>
<td>10</td>
<td>A32</td>
<td>A40</td>
<td>1240</td>
<td>A62</td>
<td>A75</td>
<td>1</td>
<td>A92</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>48</td>
<td>A143</td>
<td>A153</td>
<td>1</td>
<td>A172</td>
<td>2</td>
<td>A191</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">613</td>
<td>A11</td>
<td>24</td>
<td>A31</td>
<td>A41</td>
<td>3632</td>
<td>A61</td>
<td>A73</td>
<td>1</td>
<td>A92</td>
<td>A103</td>
<td>...</td>
<td>A123</td>
<td>22</td>
<td>A141</td>
<td>A151</td>
<td>1</td>
<td>A173</td>
<td>1</td>
<td>A191</td>
<td>A202</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">616</td>
<td>A12</td>
<td>60</td>
<td>A33</td>
<td>A43</td>
<td>9157</td>
<td>A65</td>
<td>A73</td>
<td>2</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>27</td>
<td>A143</td>
<td>A153</td>
<td>1</td>
<td>A174</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">663</td>
<td>A12</td>
<td>6</td>
<td>A33</td>
<td>A42</td>
<td>1050</td>
<td>A61</td>
<td>A71</td>
<td>4</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A122</td>
<td>35</td>
<td>A142</td>
<td>A152</td>
<td>2</td>
<td>A174</td>
<td>1</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">666</td>
<td>A12</td>
<td>30</td>
<td>A31</td>
<td>A42</td>
<td>3496</td>
<td>A64</td>
<td>A73</td>
<td>4</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A123</td>
<td>34</td>
<td>A142</td>
<td>A152</td>
<td>1</td>
<td>A173</td>
<td>2</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">667</td>
<td>A14</td>
<td>48</td>
<td>A31</td>
<td>A49</td>
<td>3609</td>
<td>A61</td>
<td>A73</td>
<td>1</td>
<td>A92</td>
<td>A101</td>
<td>...</td>
<td>A121</td>
<td>27</td>
<td>A142</td>
<td>A152</td>
<td>1</td>
<td>A173</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">684</td>
<td>A12</td>
<td>36</td>
<td>A33</td>
<td>A49</td>
<td>9857</td>
<td>A62</td>
<td>A74</td>
<td>1</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A122</td>
<td>31</td>
<td>A143</td>
<td>A152</td>
<td>2</td>
<td>A172</td>
<td>2</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">703</td>
<td>A12</td>
<td>30</td>
<td>A33</td>
<td>A49</td>
<td>2503</td>
<td>A62</td>
<td>A75</td>
<td>4</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A122</td>
<td>41</td>
<td>A142</td>
<td>A152</td>
<td>2</td>
<td>A173</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">721</td>
<td>A12</td>
<td>6</td>
<td>A31</td>
<td>A46</td>
<td>433</td>
<td>A64</td>
<td>A72</td>
<td>4</td>
<td>A92</td>
<td>A101</td>
<td>...</td>
<td>A122</td>
<td>24</td>
<td>A141</td>
<td>A151</td>
<td>1</td>
<td>A173</td>
<td>2</td>
<td>A191</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">754</td>
<td>A14</td>
<td>12</td>
<td>A33</td>
<td>A45</td>
<td>1555</td>
<td>A64</td>
<td>A75</td>
<td>4</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>55</td>
<td>A143</td>
<td>A153</td>
<td>2</td>
<td>A173</td>
<td>2</td>
<td>A191</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">774</td>
<td>A13</td>
<td>12</td>
<td>A34</td>
<td>A40</td>
<td>1480</td>
<td>A63</td>
<td>A71</td>
<td>2</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>66</td>
<td>A141</td>
<td>A153</td>
<td>3</td>
<td>A171</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">808</td>
<td>A12</td>
<td>42</td>
<td>A31</td>
<td>A41</td>
<td>9283</td>
<td>A61</td>
<td>A71</td>
<td>1</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>55</td>
<td>A141</td>
<td>A153</td>
<td>1</td>
<td>A174</td>
<td>1</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">829</td>
<td>A12</td>
<td>48</td>
<td>A33</td>
<td>A49</td>
<td>6681</td>
<td>A65</td>
<td>A73</td>
<td>4</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>38</td>
<td>A143</td>
<td>A153</td>
<td>1</td>
<td>A173</td>
<td>2</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">876</td>
<td>A11</td>
<td>18</td>
<td>A31</td>
<td>A43</td>
<td>1940</td>
<td>A61</td>
<td>A72</td>
<td>3</td>
<td>A93</td>
<td>A102</td>
<td>...</td>
<td>A124</td>
<td>36</td>
<td>A141</td>
<td>A153</td>
<td>1</td>
<td>A174</td>
<td>1</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">889</td>
<td>A14</td>
<td>28</td>
<td>A31</td>
<td>A41</td>
<td>7824</td>
<td>A65</td>
<td>A72</td>
<td>3</td>
<td>A93</td>
<td>A103</td>
<td>...</td>
<td>A121</td>
<td>40</td>
<td>A141</td>
<td>A151</td>
<td>2</td>
<td>A173</td>
<td>2</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">895</td>
<td>A14</td>
<td>36</td>
<td>A33</td>
<td>A41</td>
<td>8947</td>
<td>A65</td>
<td>A74</td>
<td>3</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A123</td>
<td>31</td>
<td>A142</td>
<td>A152</td>
<td>1</td>
<td>A174</td>
<td>2</td>
<td>A192</td>
<td>A201</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">915</td>
<td>A12</td>
<td>48</td>
<td>A30</td>
<td>A410</td>
<td>18424</td>
<td>A61</td>
<td>A73</td>
<td>1</td>
<td>A92</td>
<td>A101</td>
<td>...</td>
<td>A122</td>
<td>32</td>
<td>A141</td>
<td>A152</td>
<td>1</td>
<td>A174</td>
<td>1</td>
<td>A192</td>
<td>A202</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">927</td>
<td>A11</td>
<td>48</td>
<td>A32</td>
<td>A41</td>
<td>10297</td>
<td>A61</td>
<td>A74</td>
<td>4</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>39</td>
<td>A142</td>
<td>A153</td>
<td>3</td>
<td>A173</td>
<td>2</td>
<td>A192</td>
<td>A201</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">935</td>
<td>A12</td>
<td>30</td>
<td>A33</td>
<td>A43</td>
<td>1919</td>
<td>A62</td>
<td>A72</td>
<td>4</td>
<td>A93</td>
<td>A101</td>
<td>...</td>
<td>A124</td>
<td>30</td>
<td>A142</td>
<td>A152</td>
<td>2</td>
<td>A174</td>
<td>1</td>
<td>A191</td>
<td>A201</td>
<td>2</td>
</tr>
</tbody>
</table>

<p>50 rows × 21 columns</p>
</div>
</div>
</div>
<p>Ở trên đã sử dụng tỷ lệ 5% mẫu để xác định anomaly. Ngoài ra có thể điều chỉnh ngưỡng anomaly scores phù hợp thay vì đưa ra tỷ lệ.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify anomalies based on anomaly scores (you can set a threshold)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>threshold <span class="op">=</span> <span class="op">-</span><span class="fl">0.01</span>  <span class="co"># Adjust the threshold as needed</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>anomalies <span class="op">=</span> X[anomaly_scores <span class="op">&lt;</span> threshold]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>anomalies</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">duration</th>
<th data-quarto-table-cell-role="th">credit_amount</th>
<th data-quarto-table-cell-role="th">installment_rate</th>
<th data-quarto-table-cell-role="th">residence_since</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">existing_credits</th>
<th data-quarto-table-cell-role="th">people_liable</th>
<th data-quarto-table-cell-role="th">existing_checking_A12</th>
<th data-quarto-table-cell-role="th">existing_checking_A13</th>
<th data-quarto-table-cell-role="th">existing_checking_A14</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">property_A124</th>
<th data-quarto-table-cell-role="th">other_installment_plans_A142</th>
<th data-quarto-table-cell-role="th">other_installment_plans_A143</th>
<th data-quarto-table-cell-role="th">housing_A152</th>
<th data-quarto-table-cell-role="th">housing_A153</th>
<th data-quarto-table-cell-role="th">job_A172</th>
<th data-quarto-table-cell-role="th">job_A173</th>
<th data-quarto-table-cell-role="th">job_A174</th>
<th data-quarto-table-cell-role="th">telephone_A192</th>
<th data-quarto-table-cell-role="th">foreign_worker_A202</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">44</td>
<td>48</td>
<td>6143</td>
<td>4</td>
<td>4</td>
<td>58</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">55</td>
<td>6</td>
<td>783</td>
<td>1</td>
<td>2</td>
<td>26</td>
<td>1</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">87</td>
<td>36</td>
<td>12612</td>
<td>1</td>
<td>4</td>
<td>47</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">99</td>
<td>20</td>
<td>7057</td>
<td>3</td>
<td>4</td>
<td>36</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">175</td>
<td>30</td>
<td>7485</td>
<td>4</td>
<td>1</td>
<td>53</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">186</td>
<td>9</td>
<td>5129</td>
<td>2</td>
<td>4</td>
<td>74</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">191</td>
<td>48</td>
<td>3844</td>
<td>4</td>
<td>4</td>
<td>34</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">263</td>
<td>12</td>
<td>2748</td>
<td>2</td>
<td>4</td>
<td>57</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">272</td>
<td>48</td>
<td>12169</td>
<td>4</td>
<td>4</td>
<td>36</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">287</td>
<td>48</td>
<td>7582</td>
<td>2</td>
<td>4</td>
<td>31</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">304</td>
<td>48</td>
<td>10127</td>
<td>2</td>
<td>2</td>
<td>44</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">306</td>
<td>30</td>
<td>4811</td>
<td>2</td>
<td>4</td>
<td>24</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">374</td>
<td>60</td>
<td>14782</td>
<td>3</td>
<td>4</td>
<td>60</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">449</td>
<td>15</td>
<td>1512</td>
<td>3</td>
<td>3</td>
<td>61</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">496</td>
<td>36</td>
<td>9034</td>
<td>4</td>
<td>1</td>
<td>29</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">549</td>
<td>48</td>
<td>8858</td>
<td>2</td>
<td>1</td>
<td>35</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">595</td>
<td>6</td>
<td>931</td>
<td>1</td>
<td>1</td>
<td>32</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">602</td>
<td>24</td>
<td>1837</td>
<td>4</td>
<td>4</td>
<td>34</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">613</td>
<td>24</td>
<td>3632</td>
<td>1</td>
<td>4</td>
<td>22</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">616</td>
<td>60</td>
<td>9157</td>
<td>2</td>
<td>2</td>
<td>27</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">663</td>
<td>6</td>
<td>1050</td>
<td>4</td>
<td>1</td>
<td>35</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">667</td>
<td>48</td>
<td>3609</td>
<td>1</td>
<td>1</td>
<td>27</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">754</td>
<td>12</td>
<td>1555</td>
<td>4</td>
<td>4</td>
<td>55</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">808</td>
<td>42</td>
<td>9283</td>
<td>1</td>
<td>2</td>
<td>55</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">889</td>
<td>28</td>
<td>7824</td>
<td>3</td>
<td>4</td>
<td>40</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">895</td>
<td>36</td>
<td>8947</td>
<td>3</td>
<td>2</td>
<td>31</td>
<td>1</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>...</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">915</td>
<td>48</td>
<td>18424</td>
<td>1</td>
<td>2</td>
<td>32</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">927</td>
<td>48</td>
<td>10297</td>
<td>4</td>
<td>4</td>
<td>39</td>
<td>3</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">935</td>
<td>30</td>
<td>1919</td>
<td>4</td>
<td>3</td>
<td>30</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>29 rows × 48 columns</p>
</div>
</div>
</div>
</section>
<section id="nhược-điểm-của-isolation-forest" class="level2">
<h2 class="anchored" data-anchor-id="nhược-điểm-của-isolation-forest">Nhược điểm của Isolation Forest</h2>
<p>Isolation Forest là một thuật toán mạnh mẽ cho phát hiện dấu hiệu bất thường trong dữ liệu. Tuy nhiên, nó cũng có nhược điểm và hạn chế của riêng nó. Dưới đây là một số nhược điểm của Isolation Forest cùng với ví dụ:</p>
<p><strong>Nhược Điểm:</strong></p>
<ol type="1">
<li><p><strong>Không hiệu quả đối với dấu hiệu bất thường gần nhau:</strong> Isolation Forest không hoạt động tốt trong việc phát hiện dấu hiệu bất thường nằm gần nhau hoặc trải dài dọc theo một đường.</p></li>
<li><p><strong>Độ nhạy với giá trị ngưỡng:</strong> Việc đặt ngưỡng quyết định dấu hiệu bất thường có thể khá khó và phụ thuộc vào kiểu dữ liệu và phân phối của dữ liệu. Nếu bạn đặt ngưỡng quá thấp, có thể dẫn đến nhiều dấu hiệu giả mạo; ngược lại, nếu đặt ngưỡng quá cao, có thể bỏ lỡ nhiều dấu hiệu thực sự bất thường.</p></li>
<li><p><strong>Khả năng đối mặt với dữ liệu nhiều chiều:</strong> Isolation Forest có thể gặp khó khăn khi xử lý dữ liệu có số chiều rất lớn. Trong các không gian nhiều chiều, việc tạo ra các phân nhánh ngẫu nhiên có thể dẫn đến các cây con có chiều sâu quá thấp, làm giảm khả năng phát hiện dấu hiệu bất thường.</p></li>
</ol>
<p><strong>Ví dụ về Nhược Điểm của Isolation Forest:</strong></p>
<p>Giả sử bạn có dữ liệu về giao dịch tài chính trong một ngân hàng và bạn muốn phát hiện gian lận trong các giao dịch. Một số gian lận xảy ra với các mẫu tương tự với các giao dịch thông thường, nhưng với số lượng nhỏ và gần nhau trong không gian đặc trưng. Isolation Forest có thể không hiệu quả trong việc phát hiện các gian lận như vậy vì nó có thể đánh giá chúng là dấu hiệu thông thường do chúng không được cô lập.</p>
<p>Nhược điểm này có thể được khắc phục bằng cách sử dụng các kỹ thuật phát hiện gian lận cơ bản hơn và phù hợp hơn cho loại tình huống này hoặc bằng việc sử dụng các thuật toán khác như Local Outlier Factor (LOF) hoặc One-Class SVM.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a random seed for reproducibility</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random data for the first blob (normal data)</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>mean1 <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>cov1 <span class="op">=</span> [[<span class="dv">1</span>, <span class="fl">0.5</span>], [<span class="fl">0.5</span>, <span class="dv">1</span>]]</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>data1 <span class="op">=</span> np.random.multivariate_normal(mean1, cov1, <span class="dv">100</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate random data for the second blob (abnormal data)</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>mean2 <span class="op">=</span> [<span class="dv">7</span>, <span class="dv">7</span>]</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>cov2 <span class="op">=</span> [[<span class="dv">1</span>, <span class="op">-</span><span class="fl">0.5</span>], [<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">1</span>]]</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> np.random.multivariate_normal(mean2, cov2, <span class="dv">100</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the two sets of data</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.vstack((data1, data2))</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a scatter plot of the data</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>plt.scatter(data1[:, <span class="dv">0</span>], data1[:, <span class="dv">1</span>], marker<span class="op">=</span><span class="st">'o'</span>, c<span class="op">=</span><span class="st">'b'</span>, label<span class="op">=</span><span class="st">'Normal Data'</span>)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>plt.scatter(data2[:, <span class="dv">0</span>], data2[:, <span class="dv">1</span>], marker<span class="op">=</span><span class="st">'x'</span>, c<span class="op">=</span><span class="st">'r'</span>, label<span class="op">=</span><span class="st">'Abnormal Data'</span>)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'X-axis'</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Y-axis'</span>)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Can't distinct normal and abnormal"</span>)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="IsolationForest_files/figure-html/cell-5-output-1.png" class="img-fluid"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© CC-By NguyenNgocBinh, 2023</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>